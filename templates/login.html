<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Login</title>
        <!--suppress HtmlUnknownTarget -->
        <link rel="shortcut icon" href="/static/favicon.ico">

        <!--suppress HtmlUnknownTarget -->
        <script type="module" src="signum-bundle.min.js?v=6"></script>
        <script type="module">
            window.runSubmitLogin = function runSubmitLogin(){
                Signum.executeLogin(
                        document.getElementById("username").value, //username
                        document.getElementById("password").value, //password
                        "submit-login", //loginUrl
                        ${login_details["server-instructions"]}, //server instructions
                        window.location.pathname, //referrer
                        "${login_details['state'].decode("utf-8")}", //state
                        document.getElementById("captcha").value, //captcha
                        document.getElementById("csrf").value //csrf token
                ).then(res => {
                    if (res.passed) {
                        console.log(res)
                        window.location.href="post-login?session_key=" + res.session_key;
                    }
                });

                return false;
            }
        </script>
        <style>
            body {
                background-image: url('/static/lighthouse.jpg');
                background-size: cover;
                background-repeat: no-repeat;
            }
        </style>
    </head>
    <body>
        <table>
            <td style="vertical-align:top;">
                <table>
                    <tr>
                        <td>
                            <label>Username:
                                <input type="text" placeholder="Enter your username" name="username" id="username" required value="a">
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Password:
                                <input type="password" placeholder="Enter your password" name="password" id="password" required value="b">
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="hidden" name="csrf" id="csrf" required value="${login_details["csrfToken"]}">
                            <button onclick="runSubmitLogin();">Login</button>
                        </td>
                    </tr>
                </table>
            </td>
            <td>
                <table>
                    <tr>
                        <td>
                            <img src="${login_details["captcha"]}" alt="CAPTCHA">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Common term:
                                <input type="text" placeholder="What do you see in most of the pictures?" name="captcha" id="captcha" required value="b">
                            </label>
                        </td>
                    </tr>
                </table>
            </td>
        </table>
    </body>
</html>